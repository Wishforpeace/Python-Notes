## 原神后端模拟

#### 统一要求：

* 请求响应的 body 统一使用 JSON 格式
* 分文件，在程序很大的情况下，不分文件反而更麻烦
* 注意规范，go语言命名规范（驼峰）、mysql命名规范（小写下划线）、变量命名（英文名词，不要拼音）、http路由命名规范（restful风格，名词）

### 关系模型分析：

#### PART I 用户

**一个用户代表一个账号**，你应该能想到一个账号拥有的属性：uid、密码、用户名、头像、签名等。

原石、摩拉等货币可以放到用户表，也可以放到下述资源模块。

**传统的用户接口可以只写登录**，改密码什么的重复工作可以不用。

#### PART II 角色

**一个用户可以拥有多个角色，一个角色可以被多个用户拥有**。

角色模块又引出了**圣遗物**和**武器**。

**一个用户可以拥有多个圣遗物，一个用户也有多把武器**。

**一个角色可以装备6个圣遗物，一个角色可以装备一把武器**。

#### PART III 资源

这里的资源，指武器角色培养素材、武器突破素材、角色突破素材那些。

**一个用户可以有多种素材，一个素材可以被多个用户拥有**。

#### PART IV 抽卡

你游特色，武器角色混合。

抽到的新角色各属性应该设为默认值。

如果是重复的角色则化为命座提升道具，这个道具可以算作资源的一部分。

### 接口需求

* 登录

  标配，不赘述。

*  新增圣遗物

  我感觉原神获取圣遗物应该是从后端来的，如果不想多写一个接口，可以合并到抽卡 API，变成圣遗物、武器、角色三者混合的究极毒池！

  **注意圣遗物有种类**，像雷本的如雷、火本魔女、以及三四星的。

  **每种圣遗物又分为六个部件，需要区分圣遗物的种类和部件**。

  request传输圣遗物的种类、部位及别的信息。

  该接口将此圣遗物存储在数据库。

  传输的信息可以是如下结构：

  ```json
  {
    "id":1, // 圣遗物 id
    "index":1, // 圣遗物位置，假设 1 是死之羽
    "main_effect":{
      "id":1, // 词条 id，假设 1 代表 攻击百分比
      "value":12.6 // 词条值
    },
    "side_effect":[ // 是个数组，这里只有一个副词条
      {
        "id":1,
        "value":6.4
      }
    ]
  }
  ```

  可以传输数组，实现批量新增。

* 获取角色列表

  获取用户拥有的所有角色列表

  后端通过token/cookie解析用户id，建议用 token。并用该id获取用户的所有角色信息并返回。

  角色返回列表可以是如下结构：

  ```JSON
  [
    {
    	"id":1, // 角色 id
    	"name":"刻晴", // 角色名
    	"level":70,// 等级
    	"rank":0, // 命座
    	"weapon":{ // 武器对象
      	"id":10, // 武器 id
      	"name":"匣里龙吟", // 武器名字
      	"level":70,
      	"rank":1, // 精炼
      	"basic_attack":388, // 基础攻击力
      	"main_effect":{
        	"id":1, // 词条 id
        	"name":"attack percent", // 词条名，这里是攻击力百分比
        	"value":34.1 // 加成 %
      	},
      	"info":"balabalabala" // 武器简介
    	},
    	"artifact":[ // 圣遗物，可以看作长度为 6 的数组
      	{ // 第一个元素固定为生之花
        	"id":10,
        	"name":"如雷的盛怒",
          "level":10,
          "index":0,
        	"main_effect":{ // 主词条
          	// 同上
        	},
        	"side_effect":[] // 副词条这里应该可以看作数组
      	},
      	{ // 第二个元素固定为死之羽，以此类推
        	// 同上
      	}
      	// ... 省略下面四个圣遗物
    	]
    },
    {
      "id":2, // 角色 id
    	"name":"达达利亚", // 角色名
    	"level":80,// 等级
    	"rank":0, // 命座
    	"weapon":{ // 武器对象
      	"id":11, // 武器 id
      	"name":"弓藏", // 武器名字
      	"level":80,
      	"rank":1, // 精炼
      	"basic_attack":449, // 基础攻击力
      	"main_effect":{
        	"id":1, // 词条 id
        	"name":"attack percent", // 词条名，这里是攻击力百分比
        	"value":37.7 // 加成 %
      	},
      	"info":"balabalabala" // 武器简介
    	},
    	"artifact":[ // 圣遗物，可以看作长度为 6 的数组
      	{ // 第一个元素固定为生之花
        	"id":11,
        	"name":"沉沦之心",
          "level":10,
          "index":0,
        	"main_effect":{ // 主词条
          	// 同上
        	},
        	"side_effect":[] // 副词条这里应该可以看作数组
      	},
      	{ // 第二个元素固定为死之羽，以此类推
        	// 同上
      	}
      	// ... 省略下面四个圣遗物
    	]
    },
    // 以下省略若干角色 
   ]
  }
  ```

* 获取武器列表

  这个接口，以及下面一个主要是为了看用户都有哪些武器/圣遗物

  后端根据token解析uid，再用uid获取

  返回数据可以长这样：

  ```json
  [
    {
    	"id":11, // 武器 id
    	"name":"弓藏", // 武器名字
    	"level":80,
    	"rank":1, // 精炼
    	"basic_attack":449, // 基础攻击力
    	"main_effect":{
    		"id":1, // 词条 id
      	"name":"attack percent", // 词条名，这里是攻击力百分比
      	"value":37.7 // 加成 %
     	},
     	"info":"balabalabala" // 武器简介
  	},
    // ... 以下省略若干武器
  ]
  ```

* 获取圣遗物列表

  同上

  返回数据可以长这样：

  ```JSON
  [
    {
    	"id":11,
      "name":"沉沦之心",
      "index":0, // 表示部件，假设 0 为生之花
      "level":8, // 等级
      "main_effect":{ // 主词条
      	"id":1,
        "name":"attack percent",
        "value":20.0
      },
      "side_effect":[ // 副词条
      	{
          "id":1,
          "name":"attack percent",
          "value":7.0
        },
        {
          "id":2,
          "name":"defence percent",
          "value":8.0
        }
      ]
    },
    // ... 以下省略若干圣遗物
  ]
  ```

* 更换角色武器

  **注意武器必须是用户拥有的合法的武器**

  request 传输武器id，后端更改武器和角色的对应关系。

  **注意一把武器只能被一个用户装备。**

  > 这里有一个问题：我上面提到的武器id是武器种类的id，但是用户可以获取到多个同种类武器。那么可能需要一个新的id来标志用户的武器。或者加一个获取时间的字段来区分同种类的多把武器。

* 更换角色圣遗物

  **注意圣遗物必须是用户拥有的合法圣遗物**

  同上，**注意对应部件的圣遗物只能装备到对应圣遗物槽上。**

* 修改队伍出战配置

  本来有四个配队的，这里只要求实现一个。

  一个小队四个人，要求数据库存储该配队信息（**不要单独建新的表**）。

* 获取队伍出战配置

  获取一个长度为4的数组即可。

* 抽卡

  获取角色、武器、（圣遗物）的途径。

  request 传输单抽或者十连，后端**自动扣取原石并将获取到的角色、武器、（圣遗物）自动加到数据库中。**

  **再返回抽卡结果。**

  如果原始不够则返回失败

### 总要求

以练手为主，考察建表是否科学以及能否处理略微复杂的数据结构。

不要求全部完成，但**获取角色列表**建议完成。